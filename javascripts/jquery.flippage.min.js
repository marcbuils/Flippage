(function($){$.flippage={};$.flippage.options={width:200,height:150,shadowSize:12,delay:250,selectable:false};$.fn.flippage=function(n){var o=$.extend({},$.flippage.options,n);o.width=o.width/2;return this.each(function(){var g=$(this);var h={};g.addClass('flippage').css({width:o.width*2,height:o.height}).children('div:not(.flippage_page)').each(function(){g.append($('<div></div>').addClass('flippage_page').css({width:o.width,height:o.height}).append($(this).css({width:o.width,height:o.height})))});var i=0;var j=false;var k=false;var l=false;g.bind('previous',function(a){g.children('div').eq(i).trigger('mousedown');g.delay(o.delay).queue(function(){$(document).trigger('mouseup');g.dequeue()},'delayflip')});g.bind('next',function(a){g.children('div').eq(i+1).trigger('mousedown');g.delay(o.delay).queue(function(){$(document).trigger('mouseup');g.dequeue()},'delayflip')});var m=function(f){j=false;k=false;if(f<0||f>g.find('div').size()-1){return}i=f;g.find('div').css('-moz-transition','none').css('-webkit-transition','none').css('-o-transition','none').css('-ms-transition','none').css('transition','none');g.find('div > div').css('-moz-transition','none').css('-webkit-transition','none').css('-o-transition','none').css('-ms-transition','none').css('transition','none').css('margin-left','0px');g.find('.flippage_rshadow').remove();g.find('.flippage_lshadow').remove();g.children('div:lt('+(i)+')').hide();g.children('div').unbind('mousedown');g.children('div:gt('+(i+1)+')').hide();g.children('div').eq(i).css({left:0});g.children('div').eq(i+1).css({left:o.width});if(g.children('div').eq(i+2).size()>0){g.children('div').eq(i+1).bind('mousedown',function(e){l=true;g.delay(o.delay).queue(function(){g.clearQueue('delayflip');if(l&&!k&&!j){var a=g.children('div').eq(i);var b=g.children('div').eq(i+1);var c=g.children('div').eq(i+2);var d=g.children('div').eq(i+3);g.addClass('flippage_flipping');h.left=e.pageX-e.layerX-o.width;a.css({zIndex:1,left:0});b.css({zIndex:3,left:o.width});c.css({zIndex:4,left:o.width*2,width:0,webkitBoxShadow:'-'+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',mozBoxShadow:'-'+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',oBoxShadow:'-'+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',msBoxShadow:'-'+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',boxShadow:'-'+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)'}).append($('<div></div>').addClass('flippage_rshadow').css({width:o.width,height:o.height,opacity:1,right:0}));d.css({zIndex:2,left:o.width,width:o.width});j=true;c.show();d.show()}g.dequeue()},'delayflip');if(!o.selectable){return false}})}if(i>0){g.children('div').eq(i).bind('mousedown',function(e){l=true;g.delay(o.delay).queue(function(){g.clearQueue('delayflip');if(l&&!j&&!k){var a=g.children('div').eq(i+1);var b=g.children('div').eq(i);var c=g.children('div').eq(i-1);var d=g.children('div').eq(i-2);g.addClass('flippage_flipping');h.left=e.pageX-e.layerX;a.css({zIndex:1,left:o.width});b.show().css({zIndex:3,left:0,width:o.width}).children('div:eq(0)').css({marginLeft:0});c.css({zIndex:4,left:0,width:0,webkitBoxShadow:''+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',mozBoxShadow:''+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',oBoxShadow:''+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',msBoxShadow:''+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)',boxShadow:''+o.shadowSize+'px 0px '+o.shadowSize+'px rgb(170, 170, 170)'}).append($('<div></div>').addClass('flippage_lshadow').css({width:o.width,height:o.height,opacity:1,right:-1*o.width})).children('div:eq(0)').css({marginLeft:o.height*-1});d.css({zIndex:2,left:0,width:o.width});k=true;c.show();d.show()}g.dequeue()},'delayflip');if(!o.selectable){return false}})}};m(0);$(document).bind('mousemove',function(a){if(j){var b=g.children('div').eq(i+1);var c=g.children('div').eq(i+2);if(a.pageX<h.left){b.hide().css({width:0});c.css({left:0,width:o.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'})}else if(a.pageX-h.left<o.width){var d=(((a.pageX-h.left)/(o.width*2)))*o.shadowSize;b.hide().css({width:0});c.css({left:a.pageX-h.left,width:o.width-((a.pageX-h.left)/2),webkitBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)'})}else if(a.pageX-h.left>o.width*2){b.show().css({width:o.width});c.css({left:o.width*2,width:0,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'})}else{var d=(1-((o.width*2-(a.pageX-h.left)))/(o.width*2))*o.shadowSize;b.show().css({width:a.pageX-h.left-o.width});c.css({left:a.pageX-h.left,width:o.width-(a.pageX-h.left)/2,webkitBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)'})}c.children('.flippage_rshadow').css({opacity:1-(c.width()/o.width)})}else if(k){var b=g.children('div').eq(i);var c=g.children('div').eq(i-1);if(a.pageX-h.left>o.width&&a.pageX-h.left<o.width*2){var d=((o.width*2-(a.pageX-h.left))/o.width)*o.shadowSize;b.hide().css({width:0,left:o.width}).children('div:eq(0)').css({marginLeft:o.width*-1});c.css({left:(a.pageX-h.left)/2,width:(a.pageX-h.left)/2,webkitBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)'}).children('div:eq(0)').css({marginLeft:(a.pageX-h.left)/2-o.width})}else if(a.pageX-h.left>=o.width*2){b.hide().css({width:0,left:o.width}).children('div:eq(0)').css({marginLeft:o.width*-1});c.css({left:o.width,width:o.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('div:eq(0)').css({marginLeft:0})}else if(a.pageX<=h.left){b.show().css({width:o.width,left:0}).children('div:eq(0)').css({marginLeft:0});c.css({left:0,width:0,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('div:eq(0)').css({marginLeft:-1*o.width})}else{var d=(1-((a.pageX-h.left)/(o.width*2)))*o.shadowSize;b.show().css({width:o.width-(a.pageX-h.left),left:a.pageX-h.left}).children('div:eq(0)').css({marginLeft:(a.pageX-h.left)*-1});c.css({left:(a.pageX-h.left)/2,width:(a.pageX-h.left)/2,webkitBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)'}).children('div:eq(0)').css({marginLeft:(a.pageX-h.left)/2-o.width})}c.children('.flippage_lshadow').css({right:c.width()-o.width,opacity:1-(c.width()/o.width)})}}).bind('mouseup',function(a){l=false;if(j){var b=g.children('div').eq(i+1);var c=g.children('div').eq(i+2);g.removeClass('flippage_flipping');c.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({left:0,width:o.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('.flippage_rshadow').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({opacity:0,right:(o.width)*-1});b.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({width:0});j=false;setTimeout(function(){m(i+2)},500)}else if(k){var b=g.children('div').eq(i);var c=g.children('div').eq(i-1);g.removeClass('flippage_flipping');c.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({left:o.width,width:o.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('.flippage_lshadow').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({opacity:0,right:0});c.children('div:eq(0)').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({marginLeft:0});b.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({width:0,left:o.width}).children('div:eq(0)').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({marginLeft:o.width*-1});k=false;setTimeout(function(){m(i-2)},500)}})})};if(typeof(document.addEventListener)!=undefined){$(document).ready(function(){function touchHandler(a){var b=a.changedTouches,first=b[0],type="";switch(a.type){case"touchstart":type="mousedown";break;case"touchmove":type="mousemove";break;case"touchend":type="mouseup";break;default:return}var c=document.createEvent("MouseEvent");c.initMouseEvent(type,true,true,window,1,first.screenX,first.screenY,first.clientX,first.clientY,false,false,false,false,0,null);first.target.dispatchEvent(c);if($('.flippage_flipping').size()>0){a.preventDefault()}}document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",touchHandler,true)})}})(jQuery);